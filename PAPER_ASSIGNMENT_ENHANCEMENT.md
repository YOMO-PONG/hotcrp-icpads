# HotCRP 论文审稿分配增强功能

## 功能概述

本增强功能为HotCRP系统的论文审稿分配页面添加了"渐进式揭示"的用户体验设计，专门优化了当PC成员数量巨大时的界面显示和操作效率。

## 核心特性

### 1. 智能推荐审稿人
- **默认显示**: 基于Topic Score排名前10的PC成员
- **排序算法**: 
  - 主要依据: Topic Interest Score (降序)
  - 次要依据: Review Preference (降序)
- **视觉标识**: 推荐列表中的审稿人具有绿色左边框标识

### 2. 冲突过滤机制
- **默认开启**: "排除有冲突的审稿人"复选框默认勾选
- **动态更新**: 取消勾选后，推荐列表实时更新，包含有冲突的成员
- **视觉提示**: 有冲突的审稿人显示为半透明状态，并具有红色背景

### 3. 灵活视图切换
- **推荐视图**: 默认显示的精简推荐列表
- **完整视图**: 包含所有PC成员的传统列表
- **无缝切换**: 通过按钮轻松在两个视图间切换

### 4. 强大搜索功能
- **实时过滤**: 在完整视图中提供搜索框
- **多字段匹配**: 支持按姓名、邮箱等信息搜索
- **自动视图切换**: 开始搜索时自动切换到完整视图

## 技术实现

### 核心文件修改
- **主要文件**: `src/pages/p_assign.php`
- **修改类**: `Assign_Page`
- **新增方法**:
  - `get_recommended_reviewers()`: 计算和返回推荐审稿人
  - `print_recommended_reviewers()`: 渲染推荐审稿人界面
  - `print_all_reviewers()`: 渲染完整审稿人列表

### 数据流程
1. **数据收集**: 遍历所有PC成员，计算Topic Score和冲突状态
2. **排序**: 按Topic Score降序排列，Preference Score为次要排序
3. **过滤**: 根据冲突过滤设置筛选合适的候选人
4. **渲染**: 分别生成推荐列表和完整列表的HTML
5. **交互**: 通过JavaScript实现动态切换和搜索

### JavaScript功能模块
- **事件绑定**: 处理复选框、按钮点击、搜索输入等事件
- **视图管理**: 控制推荐视图和完整视图的显示/隐藏
- **动态过滤**: 实现基于冲突状态和搜索条件的实时过滤
- **UI更新**: 动态更新推荐列表内容和视觉样式

## 用户使用指南

### 轨道主席操作流程

1. **进入分配页面**
   - 访问论文详情页面
   - 点击"PC assignments"区域

2. **查看推荐审稿人**
   - 默认显示Topic Score最高的前10位PC成员
   - 推荐成员具有绿色左边框标识
   - 查看每位成员的Topic Score (T#) 和 Preference (P#)

3. **调整过滤设置**
   - 取消"排除有冲突的审稿人"复选框查看所有候选人
   - 有冲突的成员会以半透明+红色背景显示

4. **查看完整列表**
   - 点击"查看全部PC成员"按钮
   - 在搜索框中输入关键词快速定位特定审稿人

5. **执行分配操作**
   - 使用标准的HotCRP分配界面为选中的审稿人分配任务
   - 点击"Save assignments"保存更改

### 界面元素说明

- **绿色左边框**: 推荐的审稿人
- **红色背景**: 有利益冲突的审稿人
- **T#**: Topic Interest Score (主题兴趣分数)
- **P#**: Review Preference (审稿偏好)

## 配置选项

### 可调整参数
- **推荐数量**: 默认10个，可在`get_recommended_reviewers()`方法中修改
- **排序权重**: 可调整Topic Score和Preference的相对重要性
- **过滤策略**: 可修改冲突检测和过滤逻辑

### 扩展建议
- 可添加更多排序因子（如：审稿负荷、专业领域匹配度等）
- 可实现审稿人推荐的个性化算法
- 可添加批量分配功能

## 兼容性

### 系统要求
- HotCRP 版本: 兼容当前版本
- 浏览器: 支持ES5+的现代浏览器
- PHP: 需要支持数组排序和匿名函数

### 向后兼容
- 保留所有原有功能
- 现有的分配操作完全不受影响
- 用户可随时切换回传统的完整列表视图

## 性能优化

### 前端优化
- 使用原生JavaScript，避免额外依赖
- DOM操作最小化，提高响应速度
- CSS样式内联，减少网络请求

### 后端优化
- 复用现有的Topic Score计算逻辑
- 合理的数据结构设计，避免重复计算
- 服务器端排序，减少前端计算负荷

## 未来改进方向

1. **机器学习集成**: 基于历史分配数据训练推荐算法
2. **个性化推荐**: 根据轨道主席的历史偏好调整推荐策略
3. **批量操作**: 支持一键分配推荐的前N位审稿人
4. **可视化增强**: 添加图表展示审稿人的能力分布
5. **移动端优化**: 提供适合移动设备的响应式界面

## 注意事项

- 确保系统已正确配置Topic Interest功能
- 推荐算法基于现有的Topic Interest数据，数据质量直接影响推荐效果
- 建议定期更新PC成员的Topic Interest以保持推荐准确性 